/*
  Hello there!
  I'm Riad Loukili, a young, self-taught software engineer
  from Morocco.
  I felt a little bored in the COVID-19 lockdown and decided
  to make this project, and it sure was a lot of fun.
  I hope you like it.
  Bye
  -------
  Twitter: @RiadLoukili
  LinkedIn: /in/RiadLoukili
*/
function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,s=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==o.return||o.return()}finally{if(s)throw a}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){var e=function(){"use strict";function e(){_classCallCheck(this,e),_defineProperty(this,"elements",[])}return _createClass(e,[{key:"push",value:function(e){this.elements.push(e)}},{key:"pop",value:function(){return this.elements.shift()}},{key:"isEmpty",value:function(){return 0==this.elements.length}},{key:"size",value:function(){return this.elements.length}},{key:"remove",value:function(e){var t=this.elements.indexOf(e);t>-1&&this.elements.splice(t,1)}}]),e}(),t=function(e){return new Promise(function(t){return setTimeout(t,e)})},n=new(function(){"use strict";function n(t){var i=t.size,s=void 0===i?3:i,a=t.container;_classCallCheck(this,n),_defineProperty(this,"size",void 0),_defineProperty(this,"elements",new e),_defineProperty(this,"container",void 0),this.size=s,this.container=a}return _createClass(n,[{key:"push",value:async function(e){var n=this,i=e.icon,s=void 0===i?"information-circle-outline":i,a=e.style,r=void 0===a?"default":a,o=e.content,c=e.dismissible,l=void 0===c||c,d=document.createElement("div");d.classList.add("notification"),d.classList.add("away"),l&&d.classList.add("dismissible"),["success","error","warning","info"].includes(r)&&d.classList.add(r),d.innerHTML='\n      <div class="icon-container">\n        <ion-icon name="'.concat(s,'"></ion-icon>\n      </div>\n      <div class="message-container">\n        <p>').concat(o,'</p>\n      </div>\n      <button type="button" class="close-btn">\n        <ion-icon name="close-circle-outline"></ion-icon>\n      </button>'),this.elements.push(d),this.container.prepend(d),await t(1),d.classList.remove("away");var u=function(){n.elements.remove(d),n.remove(d)};for(d.querySelector("button").addEventListener("click",u);this.elements.size()>this.size;)this.pop();return u}},{key:"pop",value:function(){var e=this.elements.pop();this.remove(e)}},{key:"remove",value:async function(e){this.container.contains(e)&&(e.classList.add("away"),e.style.height=e.offsetHeight+"px",await t(250),e.style.height=0,await t(100),this.container.removeChild(e))}}]),n}())({container:document.getElementById("notifications"),size:3});document.getElementById("toggle").addEventListener("click",function(){var e=document.getElementById("controls");e.classList.contains("closed")?e.classList.remove("closed"):e.classList.add("closed")});var i=null,s=null,a=null,r=0,o=null,c=document.getElementById("rows_count"),l=document.getElementById("columns_count"),d=document.getElementById("starting-button"),u=document.getElementById("target-button"),m=document.getElementById("barriers-button"),v=document.getElementById("simulate-button"),y=document.getElementById("reset-button"),f=document.getElementById("check-start"),b=document.getElementById("check-target"),L=document.getElementById("check-barriers"),h=document.getElementById("root"),p=[],g=null,_=c.value,E=l.value,k=function(){_=c.value,E=l.value,g=new Array(_);for(var e=0;e<_;e++){g[e]=new Array(E);for(var t=0;t<E;t++)g[e][t]=!1}h.innerHTML="";for(var n=0;n<_;n++){var i=document.createElement("div"),s=[];i.classList.add("grid-row");for(var a=0;a<E;a++){var r=document.createElement("div");r.classList.add("grid-box"),r.dataset.x=n,r.dataset.y=a,r.id="b_".concat(n,"_").concat(a),i.appendChild(r),s.push(0)}h.appendChild(i),p.push(s)}A()},T=function(e){return function(){controls.classList.contains("closed")||controls.classList.add("closed"),i=e}},A=function(){s?(f.classList.contains("active")||f.classList.add("active"),f.innerHTML='<ion-icon name="checkmark-circle-outline"></ion-icon> Start'):(f.classList.contains("active")&&f.classList.remove("active"),f.innerHTML='<ion-icon name="close-circle-outline"></ion-icon> Start'),a?(b.classList.contains("active")||b.classList.add("active"),b.innerHTML='<ion-icon name="checkmark-circle-outline"></ion-icon> Target'):(b.classList.contains("active")&&b.classList.remove("active"),b.innerHTML='<ion-icon name="close-circle-outline"></ion-icon> Target'),r>0?(L.classList.contains("active")||L.classList.add("active"),L.innerHTML='<ion-icon name="checkmark-circle-outline"></ion-icon> Barriers'):(L.classList.contains("active")&&L.classList.remove("active"),L.innerHTML='<ion-icon name="help-circle-outline"></ion-icon> Barriers')};k();var w=function(){p=[],g=null,i=null,s=null,a=null,r=0,o=null,k()};c.addEventListener("change",w),l.addEventListener("change",w),d.addEventListener("click",T("starting")),u.addEventListener("click",T("target")),m.addEventListener("click",T("barriers")),h.addEventListener("click",function(e){var t=e.target;t.classList.contains("grid-box")&&null!=i&&("starting"==i?(s&&(s.classList.remove("starting"),s.innerHTML="",p[s.dataset.x][s.dataset.y]=0),t.classList.contains("target")&&(t.classList.remove("target"),t.innerHTML="",a=null),t.classList.contains("barrier")&&(t.classList.remove("barrier"),t.innerHTML="",--r),(s=t).classList.add("starting"),s.innerHTML='<ion-icon name="home-outline"></ion-icon>',p[t.dataset.x][t.dataset.y]=1,o=[Number(t.dataset.x),Number(t.dataset.y)],i=null,controls.classList.contains("closed")&&controls.classList.remove("closed")):"target"==i?(a&&(a.classList.remove("target"),a.innerHTML="",p[a.dataset.x][a.dataset.y]=0),t.classList.contains("starting")&&(t.classList.remove("starting"),t.innerHTML="",s=null),t.classList.contains("barrier")&&(t.classList.remove("barrier"),t.innerHTML="",--r),(a=t).classList.add("target"),a.innerHTML='<ion-icon name="golf-outline"></ion-icon>',p[t.dataset.x][t.dataset.y]=2,i=null,controls.classList.contains("closed")&&controls.classList.remove("closed")):"barriers"==i&&(t.classList.contains("starting")&&(t.classList.remove("starting"),t.innerHTML="",s=null),t.classList.contains("target")&&(t.classList.remove("target"),t.innerHTML="",a=null),t.classList.contains("barrier")?(t.classList.remove("barrier"),t.innerHTML="",p[t.dataset.x][t.dataset.y]=0,--r):(t.classList.add("barrier"),t.innerHTML='<ion-icon name="close-outline"></ion-icon>',p[t.dataset.x][t.dataset.y]=3,++r)),A())}),v.addEventListener("click",async function(){if(s&&a){controls.classList.contains("closed")||controls.classList.add("closed"),c.setAttribute("disabled",!0),c.parentElement.classList.add("disabled"),l.setAttribute("disabled",!0),l.parentElement.classList.add("disabled"),d.setAttribute("disabled",!0),u.setAttribute("disabled",!0),m.setAttribute("disabled",!0),v.setAttribute("disabled",!0),y.setAttribute("disabled",!0);var i=new e,r=new Map;r[o]=[-1,-1],i.push(o);for(var f=null;!i.isEmpty();){var b=_slicedToArray(i.pop(),2),L=b[0],h=b[1];if(L=Number(L),h=Number(h),!g[L][h]){if(g[L][h]=!0,H(L,h),await t(50),2==p[L][h]){f=[L,h];break}await t(50),I(L+1,h)&&(i.push([L+1,h]),B(L+1,h),g[L+1][h]||(r[[L+1,h]]=[L,h])),I(L,h-1)&&(i.push([L,h-1]),B(L,h-1),g[L][h-1]||(r[[L,h-1]]=[L,h])),I(L-1,h)&&(i.push([L-1,h]),B(L-1,h),g[L-1][h]||(r[[L-1,h]]=[L,h])),I(L,h+1)&&(i.push([L,h+1]),B(L,h+1),g[L][h+1]||(r[[L,h+1]]=[L,h]))}}if(null!=f){for(var _=0;-1!==f[0]&&-1!=f[1];)M(f[0],f[1]),++_,f=r[f];n.push({content:"Simulation finished, the shortest path is of length ".concat(_-1,"."),style:"success",icon:"checkmark-outline"})}else n.push({content:"No path was found from start to target.",style:"error",icon:"golf-outline"});y.removeAttribute("disabled")}else n.push({content:"Please, choose a start and a target.",style:"warning",icon:"warning-outline"})}),y.addEventListener("click",function(){w(),c.removeAttribute("disabled"),c.parentElement.classList.remove("disabled"),l.removeAttribute("disabled"),l.parentElement.classList.remove("disabled"),d.removeAttribute("disabled"),u.removeAttribute("disabled"),m.removeAttribute("disabled"),v.removeAttribute("disabled"),n.push({content:"Simulation was successfully reset.",style:"success",icon:"refresh-outline"})});var I=function(e,t){return e>=0&&e<_&&t>=0&&t<E&&3!=p[e][t]},H=function(e,t){var n="b_".concat(e,"_").concat(t),i=document.getElementById(n);i&&(i.classList.contains("visiting")&&i.classList.remove("visiting"),i.classList.add("visited"))},M=function(e,t){var n="b_".concat(e,"_").concat(t),i=document.getElementById(n);i&&i.classList.add("path")},B=function(e,t){var n="b_".concat(e,"_").concat(t),i=document.getElementById(n);if(i){if(i.classList.contains("starting")||i.classList.contains("target"))return;i.classList.add("visiting")}};n.push({content:'\n    Only the <span style="color: #86c7a1;">start</span> and the <span style="color: #8db9d6;">target</span> are required to start a simulation, <span style="color: #e6a8a1;">barriers</span> are optional.\n    <br><span style="color:#6d6d6d;font-size:10px;display:inline-block;margin-top:4px;">by @RiadLoukili</span>',icon:"information-circle-outline",style:"info"})}();